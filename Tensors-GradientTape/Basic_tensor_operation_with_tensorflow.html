#!/usr/bin/env python
# coding: utf-8

# # Basic Tensor operations
# 
# In this notebook you will see different kind of mathematical operations on tensors using tensorflow. Tensor can store data in variety of way. In this notebook, you will explore how they are used.

# In[18]:


import tensorflow as tf
import numpy as np


# ##  [tf.constant]((https://www.tensorflow.org/api_docs/python/tf/constant))
# 
# Creates a constant tensor from a tensor-like object. 

# In[19]:


# Convert NumPy array to Tensor using `tf.constant`
def tf_constant(array):
    """
    Args:
        array (numpy.ndarray): tensor-like array.

    Returns:
        tensorflow.python.framework.ops.EagerTensor: tensor.
    """
    
    tf_constant_array = tf.constant(array)
    
    return tf_constant_array


# In[21]:


tmp_array = np.arange(1,10)
x = tf_constant(tmp_array)

x
# Expected output:
# <tf.Tensor: shape=(9,), dtype=int64, numpy=array([1, 2, 3, 4, 5, 6, 7, 8, 9])>


# Note that for future docstrings, the type `EagerTensor` will be used as a shortened version of `tensorflow.python.framework.ops.EagerTensor`.

# ##  [tf.square](https://www.tensorflow.org/api_docs/python/tf/math/square)
# 
# Computes the square of a tensor element-wise.

# In[22]:


# Square the input tensor
def tf_square(array):
    """
    Args:
        array (numpy.ndarray): tensor-like array.

    Returns:
        EagerTensor: tensor.
    """
    # make sure it's a tensor
    array = tf.constant(array)
    
    
    tf_squared_array = tf.square(array)
    
    return tf_squared_array


# In[23]:


tmp_array = tf.constant(np.arange(1, 10))
x = tf_square(tmp_array)
x

# Expected output:
# <tf.Tensor: shape=(9,), dtype=int64, numpy=array([ 1,  4,  9, 16, 25, 36, 49, 64, 81])>


# ##  [tf.reshape](https://www.tensorflow.org/api_docs/python/tf/reshape)
# 
# Reshapes a tensor.

# In[24]:


# Reshape tensor into the given shape parameter
def tf_reshape(array, shape):
    """
    Args:
        array (EagerTensor): tensor to reshape.
        shape (tuple): desired shape.

    Returns:
        EagerTensor: reshaped tensor.
    """
    # make sure it's a tensor
    array = tf.constant(array)
    
    tf_reshaped_array = tf.reshape(array, shape)
    
    return tf_reshaped_array


# In[25]:


# Check your function
tmp_array = np.array([1,2,3,4,5,6,7,8,9])
# Check that your function reshapes a vector into a matrix
x = tf_reshape(tmp_array, (3, 3))
x

# Expected output:
# <tf.Tensor: shape=(3, 3), dtype=int64, numpy=
# [[1, 2, 3],
# [4, 5, 6],
# [7, 8, 9]]


# ##  [tf.cast](https://www.tensorflow.org/api_docs/python/tf/cast)
# 
# Casts a tensor to a new type.

# In[26]:


# Cast tensor into the given dtype parameter
def tf_cast(array, dtype):
    """
    Args:
        array (EagerTensor): tensor to be casted.
        dtype (tensorflow.python.framework.dtypes.DType): desired new type. (Should be a TF dtype!)

    Returns:
        EagerTensor: casted tensor.
    """
    # make sure it's a tensor
    array = tf.constant(array)

    
    tf_cast_array = tf.cast(array, dtype = dtype)
    
    return tf_cast_array


# In[27]:


# Check your function
tmp_array = [1,2,3,4]
x = tf_cast(tmp_array, tf.float32)
x

# Expected output:
# <tf.Tensor: shape=(4,), dtype=float32, numpy=array([1., 2., 3., 4.], dtype=float32)>


# ## [tf.multiply](https://www.tensorflow.org/api_docs/python/tf/multiply)
# 
# Returns an element-wise x * y.

# In[28]:


# Multiply tensor1 and tensor2
def tf_multiply(tensor1, tensor2):
    """
    Args:
        tensor1 (EagerTensor): a tensor.
        tensor2 (EagerTensor): another tensor.

    Returns:
        EagerTensor: resulting tensor.
    """
    # make sure these are tensors
    tensor1 = tf.constant(tensor1)
    tensor2 = tf.constant(tensor2)
    
    
    product = tf.multiply(tensor1,tensor2)
    
    return product


# In[29]:


# Check your function
tmp_1 = tf.constant(np.array([[1,2],[3,4]]))
tmp_2 = tf.constant(np.array(2))
result = tf_multiply(tmp_1, tmp_2)
result

# Expected output:
# <tf.Tensor: shape=(2, 2), dtype=int64, numpy=
# array([[2, 4],
#        [6, 8]])>


# ## [tf.add](https://www.tensorflow.org/api_docs/python/tf/add)
# 
# Returns x + y element-wise.

# In[31]:


# Add tensor1 and tensor2
def tf_add(tensor1, tensor2):
    """
    Args:
        tensor1 (EagerTensor): a tensor.
        tensor2 (EagerTensor): another tensor.

    Returns:
        EagerTensor: resulting tensor.
    """
    # make sure these are tensors
    tensor1 = tf.constant(tensor1)
    tensor2 = tf.constant(tensor2)
    
    
    total = tf.add(tensor1, tensor2)
    
    return total


# In[33]:


# Check your function
tmp_1 = tf.constant(np.array([1, 2, 3]))
tmp_2 = tf.constant(np.array([4, 5, 6]))
tf_add(tmp_1, tmp_2)

# Expected output:
# <tf.Tensor: shape=(3,), dtype=int64, numpy=array([5, 7, 9])>

